---
title: "ã€Flutterã€‘iOSãƒ“ãƒ«ãƒ‰å‘¨ã‚Šã®ã‚¨ãƒ©ãƒ¼é›†"
emoji: "ğŸ’»"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Flutter,Dart,iOS]
published: true
---
&nbsp;
## â‘ 
ã€ã‚¨ãƒ©ãƒ¼å†…å®¹ã€‘
CocoaPodsã®VerãŒå¤ã„ã‹ã‚‰updateã—ã¦ã­ã€‚
```
Error: CocoaPods's specs repository is too out-of-date to satisfy dependencies.
To update the CocoaPods specs, run:
  pod repo update
```
ã€è§£æ±ºæ–¹æ³•ã€‘
 ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰æ‰‹é †ã§è§£æ±º [^1]
```text: project/iosãƒ‘ã‚¹ã«ã¦
1. rm Podfile.lock
2. brew upgrade cocoapods
3. pod install --repo-update
4. flutter clean
```

&nbsp;
## â‘¡
ã€ã‚¨ãƒ©ãƒ¼å†…å®¹ã€‘
xcodeã®ãƒ“ãƒ«ãƒ‰è¨­å®šãŒä¸Šæ‰‹ãã„ã£ã¦ãªã„ã‹ã‚‰ãƒ“ãƒ«ãƒ‰ã§ããªã„ã‚ˆã€‚(arm64ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯å¯¾å¿œã—ã¦ãªã„ã‹ã‚‰é™¤å¤–ã—ã¦ã­)
```
Error (Xcode): Building for iOS Simulator, but linking in dylib built for iOS, file '/Users/<ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‘ã‚¹>/ios/Pods/<TARGETå>' for architecture arm64

Could not build the application for the simulator.
```
ã€è§£æ±ºæ–¹æ³•ã€‘
Xcodeã®ä»¥ä¸‹ã®ãƒ‘ã‚¹ã«ã¦ã€ŒAny iOS Simulator SKD : arm64ã€ã¨æ‰‹å‹•ã§è¨­å®šã—ãŸã‚‰è§£æ±º [^2] [^3]
```
Xcode > Pods > [TAEGETé…ä¸‹ã®ã‚¨ãƒ©ãƒ¼å¯¾è±¡ã®ã‚‚ã®] > Build Settings > Architectures > Excluded Architectures
```

![](/images/3a857b86626a0e/xcode.png =400x)

**ã€è£œè¶³ã€‘**
ä¸Šè¨˜ã ã¨æ‰‹å‹•è¨­å®šãªã®ã§ã€ãƒãƒ¼ãƒ é–‹ç™ºã¨ã‹ã ã¨çš†ãŒåŒã˜è¨­å®šã—ãªã„ã¨ã„ã‘ãªã„ã®ã§ã‚ã‚“ã©ãã•ã„ã€‚
â†’Podfileã‚’ä¿®æ­£ã—ã¦ã€ãƒ“ãƒ«ãƒ‰æ™‚ã«è‡ªå‹•ã§ä¸Šè¨˜ã®é™¤å¤–è¨­å®šã‚’ã—ã¦ãã‚Œã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã®ãŒè‰¯ã„ã‹ã¨ã€‚ [^4]

```yaml:Podfile
post_install do |installer|
  installer.pods_project.targets.each do |target|
    flutter_additional_ios_build_settings(target)
  end

  # 'arm64'é™¤å¤–è¨­å®šå¯¾è±¡ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
  arm64_excluded_target_names = ['TARGETåâ‘ ','TARGETåâ‘¡']

  # å¯¾è±¡ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ ã‚’æ¢ã™
  arm64_excluded_target_names.each do |target_name|
      pods_target = installer.pods_project.targets.find{ |target| target.name == target_name }
      unless pods_target
          raise ::Pod::Informative, "Failed to find '" << target_name << "' target"
      end

      # "Excluded Architectures"ã«"arm64"ã‚’è¿½åŠ 
      pods_target.build_configurations.each do |config|
          config.build_settings["EXCLUDED_ARCHS[sdk=iphonesimulator*]"] = "arm64"
      end
  end
end
```

&nbsp;
## â‘¢
ã€ã‚¨ãƒ©ãƒ¼å†…å®¹ã€‘
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ:"RunnerTest"ãŒè¦‹ã¤ã‘ã‚Œãªã„ã‚ˆã€‚
```
[!] Unable to find a target named `RunnerTests` in project `Runner.xcodeproj`, did find `Runner`.
```

ã€è§£æ±ºæ–¹æ³•ã€‘
åŸå› ãŒã‚ˆãåˆ†ã‹ã‚‰ãªã„ãŒã€ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ãŸã‚‰buildã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã€‚
ã“ã‚ŒãŒæœ¬è³ªçš„ã«OKãªå¯¾å¿œãªã®ã‹ã¯ä¸æ˜ã€‚ã¨ã‚Šã‚ãˆãšå•é¡Œãªãå‹•ã„ã¦ã‚¨ãƒ©ãƒ¼ã‚‚ç„¡ããªã£ãŸã®ã§è‰¯ã—ã¨ã™ã‚‹ã€‚
ï¼ˆä»Šå¾Œå½±éŸ¿ãŒå‡ºãŸå ´åˆã¯è¿½è¨˜ä¿®æ­£äºˆå®šï¼‰
```diff yaml:Podfile
target 'Runner' do
  use_frameworks!
  use_modular_headers!

  flutter_install_all_ios_pods File.dirname(File.realpath(__FILE__))
    
-  target 'RunnerTests' do
-    inherit! :search_paths
-  end
+ # ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ
+ # target 'RunnerTests' do
+ #   inherit! :search_paths
+ #  end
end


```

&nbsp;
## â‘£
ã€ã‚¨ãƒ©ãƒ¼å†…å®¹ã€‘
CocoaPodsè¨­å®šã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ãŒã§ããªã„ã‚ˆã€‚
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§CocoaPodsã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­å®šã«CocoaPodsè¨­å®šã‚’å«ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚ˆã€‚
```
[!] CocoaPods did not set the base configuration of your project because your project already has a custom config set. 
In order for CocoaPods integration to work at all, please either set the base configurations of the target `Runner` to `Target Support Files/Pods-Runner/Pods-Runner.profile.xcconfig` or include the `Target Support Files/Pods-Runner/Pods-Runner.profile.xcconfig` in your build configuration (`Flutter/Release.xcconfig`).
```

ã€è§£æ±ºæ–¹æ³•ã€‘
ios/Flutter/Release.xcconfigã«ä¸€æ–‡è¿½åŠ ã€‚[^5]
```xconfig: ios/Flutter/Release.xcconfig
#include "Target Support Files/Pods-Runner/Pods-Runner.profile.xcconfig"
```

&nbsp;
## â‘¤
ã€ã‚¨ãƒ©ãƒ¼å†…å®¹ã€‘

```

```

ã€è§£æ±ºæ–¹æ³•ã€‘

```

```

## ç•ªå¤–ç·¨
ã€å•é¡Œã€‘
Firebaseã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã®iOSãƒ“ãƒ«ãƒ‰ãŒã‚‚ã®ã™ã”ãæ™‚é–“ãŒã‹ã‹ã‚‹ã®ã§ã€ãƒ“ãƒ«ãƒ‰é«˜é€ŸåŒ–è¨­å®šã¯ãƒã‚¹ãƒˆã§ã—ã¦ãŠããŸã„ã€‚[^6]

ã€è§£æ±ºæ–¹æ³•ã€‘
Podfileã«ä¸€è¡Œè¿½åŠ ã™ã‚‹ã ã‘ã€‚

```yaml:Podfile
target 'Runner' do
  use_frameworks!
  use_modular_headers!
  # iOS build ã®é«˜é€ŸåŒ– â€»ä½¿ç”¨ã—ã¦ã„ã‚‹Firestoreãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã£ã¦tagã®å€¤ã¯ã‚¤ã‚¸ã‚‹å¿…è¦ã‚ã‚Šã€‚
  pod 'FirebaseFirestore', :git => 'https://github.com/invertase/firestore-ios-sdk-frameworks.git', :tag => '9.6.0'
  flutter_install_all_ios_pods File.dirname(File.realpath(__FILE__))
end
```



&nbsp;
[^1]: [ã€Œã€è§£æ±ºã€‘Flutterã§ã€ŒCocoaPodsâ€™s specs repository is too out-of-date to satisfy dependencies.ã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã€](https://www.ryu-nosu.com/cocoapods-satisfy-dependencies/)
[^2]: [ã€ŒM1 Mac & Xcodeã§ã€Œbuilding for iOS Simulator, but linking in object file ... for architecture arm64ã€ã‚¨ãƒ©ãƒ¼ã®å¯¾å‡¦æ³•ã€](https://qiita.com/littleossa/items/ff75b19e0ac6713941f8)
[^3]: [ã€Œ[iOS] Xcode12.0ã§ã€Œbuilding for iOS Simulator, but linking in object file ... for architecture arm64ã€ã‚¨ãƒ©ãƒ¼ã®å¯¾å‡¦æ³•ã€](http://blog.be-style.jpn.com/article/187942746.html)
[^4]: [ã€ŒiOSã€ CocoaPodsã«ã‚ˆã£ã¦è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®Build Settingsã‚’å¤‰æ›´ã™ã‚‹](https://dev.classmethod.jp/articles/change-build-settings-of-cocoapods-library-target/)
[^5]: [Flutter: CocoaPodã‹ã‚‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹éš›ã«èµ·ããŸã‚¨ãƒ©ãƒ¼ã®å¯¾å‡¦](https://qiita.com/kokikudo/items/ddc6552df4fb71328a99)
[^6]: [invertase/firestore-ios-sdk-frameworks](https://github.com/invertase/firestore-ios-sdk-frameworks)